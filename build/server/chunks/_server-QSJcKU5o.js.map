{"version":3,"file":"_server-QSJcKU5o.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/create-payment-intent/_server.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nimport Stripe from \"stripe\";\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY || \"sk_test_your_secret_key_here\", {\n  apiVersion: \"2023-10-16\"\n});\nasync function POST({ request }) {\n  try {\n    console.log(\"üí≥ Creating Stripe payment intent...\");\n    const { amount, currency = \"usd\", serviceType, customerInfo, diagnosticData } = await request.json();\n    if (!amount || !customerInfo?.email || !serviceType) {\n      return json(\n        { success: false, error: \"Missing required payment information\" },\n        { status: 400 }\n      );\n    }\n    const paymentIntent = await stripe.paymentIntents.create({\n      amount: Math.round(amount * 100),\n      // Convert to cents\n      currency,\n      metadata: {\n        serviceType,\n        customerEmail: customerInfo.email,\n        customerName: customerInfo.name || \"Unknown\",\n        equipmentType: diagnosticData?.equipmentType || \"Unknown\",\n        timestamp: (/* @__PURE__ */ new Date()).toISOString(),\n        source: \"diagnosticpro-mvp\"\n      },\n      receipt_email: customerInfo.email,\n      description: `DiagnosticPro ${serviceType} service - ${diagnosticData?.equipmentType || \"Equipment\"} diagnosis`\n    });\n    console.log(`‚úÖ Payment intent created: ${paymentIntent.id} for $${amount}`);\n    return json({\n      success: true,\n      clientSecret: paymentIntent.client_secret,\n      paymentIntentId: paymentIntent.id,\n      amount\n    });\n  } catch (error) {\n    console.error(\"‚ùå Failed to create payment intent:\", error);\n    return json(\n      {\n        success: false,\n        error: \"Failed to create payment. Please try again.\",\n        details: error.message\n      },\n      { status: 500 }\n    );\n  }\n}\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,MAAM,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,8BAA8B,EAAE;AAC3F,EAAE,UAAU,EAAE;AACd,CAAC,CAAC;AACF,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,EAAE;AACjC,EAAE,IAAI;AACN,IAAI,OAAO,CAAC,GAAG,CAAC,sCAAsC,CAAC;AACvD,IAAI,MAAM,EAAE,MAAM,EAAE,QAAQ,GAAG,KAAK,EAAE,WAAW,EAAE,YAAY,EAAE,cAAc,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AACxG,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,YAAY,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE;AACzD,MAAM,OAAO,IAAI;AACjB,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,sCAAsC,EAAE;AACzE,QAAQ,EAAE,MAAM,EAAE,GAAG;AACrB,OAAO;AACP,IAAI;AACJ,IAAI,MAAM,aAAa,GAAG,MAAM,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC;AAC7D,MAAM,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;AACtC;AACA,MAAM,QAAQ;AACd,MAAM,QAAQ,EAAE;AAChB,QAAQ,WAAW;AACnB,QAAQ,aAAa,EAAE,YAAY,CAAC,KAAK;AACzC,QAAQ,YAAY,EAAE,YAAY,CAAC,IAAI,IAAI,SAAS;AACpD,QAAQ,aAAa,EAAE,cAAc,EAAE,aAAa,IAAI,SAAS;AACjE,QAAQ,SAAS,EAAE,iBAAiB,IAAI,IAAI,EAAE,EAAE,WAAW,EAAE;AAC7D,QAAQ,MAAM,EAAE;AAChB,OAAO;AACP,MAAM,aAAa,EAAE,YAAY,CAAC,KAAK;AACvC,MAAM,WAAW,EAAE,CAAC,cAAc,EAAE,WAAW,CAAC,WAAW,EAAE,cAAc,EAAE,aAAa,IAAI,WAAW,CAAC,UAAU;AACpH,KAAK,CAAC;AACN,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,0BAA0B,EAAE,aAAa,CAAC,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;AAC/E,IAAI,OAAO,IAAI,CAAC;AAChB,MAAM,OAAO,EAAE,IAAI;AACnB,MAAM,YAAY,EAAE,aAAa,CAAC,aAAa;AAC/C,MAAM,eAAe,EAAE,aAAa,CAAC,EAAE;AACvC,MAAM;AACN,KAAK,CAAC;AACN,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,oCAAoC,EAAE,KAAK,CAAC;AAC9D,IAAI,OAAO,IAAI;AACf,MAAM;AACN,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,KAAK,EAAE,6CAA6C;AAC5D,QAAQ,OAAO,EAAE,KAAK,CAAC;AACvB,OAAO;AACP,MAAM,EAAE,MAAM,EAAE,GAAG;AACnB,KAAK;AACL,EAAE;AACF;;;;"}